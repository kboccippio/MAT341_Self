%We will perform linear least squares to find a best fit function through
%data.

function fit_Sine_Series()

% number of data points
N = 500;

M = 40;

xData = linspace(-pi, pi, N);
yData = ( (0.25*xData.^2).* cos(xData).^4.*sin(xData).^7); %apostrophe will 
%make it a column vector and "." will perform component wise multiplication
% (rather than trying to multiply vectors together)

for i = 1:N
   x = xData(i);
   y = yData(i);
   
   %need to make a matrix to store the x's
   for j = 1:M 
    x_Matrix(i, j) = sin(j*x);
   end
   
   %need to make a vector to store the y's
    y_Vector(i, :)= y;
   
end

%use pseudo-inverse to calculate beta vector
beta_vector = inv(x_Matrix'*x_Matrix) * x_Matrix' * y_Vector;

%find function value using beta
for i = 1:N %we want to use all the x values
    
    %get all the x values
    x =xData(i);
    
   %intitialize summation vector
   f(i, 1) = 0;
   
   for j = 1:M
    f(i, 1) = f(i,1) + beta_vector(j) * sin(j*x);
   end
   
   %residual = B-A*beta
   res = y_Vector - x_Matrix * beta_vector;
   
   %calculate new error
   err = sqrt(res' * res);
   
end

res

plot(xData, yData, 'blue', 'linewidth', 6);
hold on
plot(xData, f, 'red', 'linewidth', 4);
legend('Data', 'Best Sine Series Fit');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% a) When M = 5, the residual is
%
%    -0.0000
%    -0.0001
%    -0.0001
%    -0.0002
%    -0.0002
%    -0.0003
%    -0.0003
%    -0.0003
%    -0.0003
%    -0.0003
%    -0.0003
%    -0.0003
%    -0.0002
%    -0.0001
%    -0.0001
%     0.0001
%     0.0002
%     0.0003
%     0.0005
%     0.0007
%     0.0009
%     0.0011
%     0.0013
%     0.0015
%     0.0018
%     0.0021
%     0.0023
%     0.0026
%     0.0028
%     0.0031
%     0.0033
%     0.0036
%     0.0038
%     0.0040
%     0.0041
%     0.0043
%     0.0044
%     0.0044
%     0.0044
%     0.0044
%     0.0043
%     0.0042
%     0.0040
%     0.0038
%     0.0035
%     0.0032
%     0.0028
%     0.0024
%     0.0019
%     0.0014
%     0.0009
%     0.0003
%    -0.0003
%    -0.0009
%    -0.0016
%    -0.0022
%    -0.0028
%    -0.0035
%    -0.0041
%    -0.0047
%    -0.0052
%    -0.0058
%    -0.0062
%    -0.0067
%    -0.0070
%    -0.0074
%    -0.0076
%    -0.0078
%    -0.0079
%    -0.0079
%    -0.0078
%    -0.0077
%    -0.0075
%    -0.0072
%    -0.0068
%    -0.0064
%    -0.0059
%    -0.0053
%    -0.0047
%    -0.0040
%    -0.0033
%    -0.0026
%    -0.0018
%    -0.0010
%    -0.0002
%     0.0005
%     0.0013
%     0.0021
%     0.0028
%     0.0036
%     0.0042
%     0.0048
%     0.0054
%     0.0059
%     0.0064
%     0.0068
%     0.0071
%     0.0073
%     0.0075
%     0.0076
%     0.0076
%     0.0076
%     0.0075
%     0.0073
%     0.0070
%     0.0067
%     0.0064
%     0.0060
%     0.0056
%     0.0051
%     0.0046
%     0.0041
%     0.0035
%     0.0030
%     0.0024
%     0.0019
%     0.0013
%     0.0008
%     0.0002
%    -0.0003
%    -0.0007
%    -0.0012
%    -0.0016
%    -0.0020
%    -0.0023
%    -0.0026
%    -0.0029
%    -0.0032
%    -0.0034
%    -0.0035
%    -0.0037
%    -0.0038
%    -0.0039
%    -0.0039
%    -0.0040
%    -0.0040
%    -0.0039
%    -0.0039
%    -0.0038
%    -0.0038
%    -0.0037
%    -0.0036
%    -0.0035
%    -0.0034
%    -0.0033
%    -0.0032
%    -0.0031
%    -0.0030
%    -0.0029
%    -0.0027
%    -0.0026
%    -0.0025
%    -0.0024
%    -0.0022
%    -0.0021
%    -0.0020
%    -0.0018
%    -0.0017
%    -0.0015
%    -0.0014
%    -0.0012
%    -0.0010
%    -0.0008
%    -0.0007
%    -0.0004
%    -0.0002
%    -0.0000
%     0.0002
%     0.0004
%     0.0007
%     0.0009
%     0.0012
%     0.0014
%     0.0017
%     0.0019
%     0.0021
%     0.0024
%     0.0026
%     0.0028
%     0.0030
%     0.0032
%     0.0034
%     0.0035
%     0.0037
%     0.0038
%     0.0039
%     0.0039
%     0.0040
%     0.0040
%     0.0040
%     0.0040
%     0.0039
%     0.0038
%     0.0037
%     0.0036
%     0.0034
%     0.0033
%     0.0031
%     0.0028
%     0.0026
%     0.0023
%     0.0021
%     0.0018
%     0.0015
%     0.0012
%     0.0009
%     0.0006
%     0.0002
%    -0.0001
%    -0.0004
%    -0.0007
%    -0.0010
%    -0.0013
%    -0.0016
%    -0.0019
%    -0.0022
%    -0.0024
%    -0.0027
%    -0.0029
%    -0.0031
%    -0.0033
%    -0.0035
%    -0.0036
%    -0.0038
%    -0.0039
%    -0.0039
%    -0.0040
%    -0.0040
%    -0.0040
%    -0.0040
%    -0.0040
%    -0.0040
%    -0.0039
%    -0.0038
%    -0.0037
%    -0.0035
%    -0.0034
%    -0.0032
%    -0.0030
%    -0.0028
%    -0.0026
%    -0.0024
%    -0.0021
%    -0.0018
%    -0.0016
%    -0.0013
%    -0.0010
%    -0.0007
%    -0.0004
%    -0.0001
%     0.0001
%     0.0004
%     0.0007
%     0.0010
%     0.0013
%     0.0016
%     0.0018
%     0.0021
%     0.0024
%     0.0026
%     0.0028
%     0.0030
%     0.0032
%     0.0034
%     0.0035
%     0.0037
%     0.0038
%     0.0039
%     0.0040
%     0.0040
%     0.0040
%     0.0040
%     0.0040
%     0.0040
%     0.0039
%     0.0039
%     0.0038
%     0.0036
%     0.0035
%     0.0033
%     0.0031
%     0.0029
%     0.0027
%     0.0024
%     0.0022
%     0.0019
%     0.0016
%     0.0013
%     0.0010
%     0.0007
%     0.0004
%     0.0001
%    -0.0002
%    -0.0006
%    -0.0009
%    -0.0012
%    -0.0015
%    -0.0018
%    -0.0021
%    -0.0023
%    -0.0026
%    -0.0028
%    -0.0031
%    -0.0033
%    -0.0034
%    -0.0036
%    -0.0037
%    -0.0038
%    -0.0039
%    -0.0040
%    -0.0040
%    -0.0040
%    -0.0040
%    -0.0039
%    -0.0039
%    -0.0038
%    -0.0037
%    -0.0035
%    -0.0034
%    -0.0032
%    -0.0030
%    -0.0028
%    -0.0026
%    -0.0024
%    -0.0021
%    -0.0019
%    -0.0017
%    -0.0014
%    -0.0012
%    -0.0009
%    -0.0007
%    -0.0004
%    -0.0002
%     0.0000
%     0.0002
%     0.0004
%     0.0007
%     0.0008
%     0.0010
%     0.0012
%     0.0014
%     0.0015
%     0.0017
%     0.0018
%     0.0020
%     0.0021
%     0.0022
%     0.0024
%     0.0025
%     0.0026
%     0.0027
%     0.0029
%     0.0030
%     0.0031
%     0.0032
%     0.0033
%     0.0034
%     0.0035
%     0.0036
%     0.0037
%     0.0038
%     0.0038
%     0.0039
%     0.0039
%     0.0040
%     0.0040
%     0.0039
%     0.0039
%     0.0038
%     0.0037
%     0.0035
%     0.0034
%     0.0032
%     0.0029
%     0.0026
%     0.0023
%     0.0020
%     0.0016
%     0.0012
%     0.0007
%     0.0003
%    -0.0002
%    -0.0008
%    -0.0013
%    -0.0019
%    -0.0024
%    -0.0030
%    -0.0035
%    -0.0041
%    -0.0046
%    -0.0051
%    -0.0056
%    -0.0060
%    -0.0064
%    -0.0067
%    -0.0070
%    -0.0073
%    -0.0075
%    -0.0076
%    -0.0076
%    -0.0076
%    -0.0075
%    -0.0073
%    -0.0071
%    -0.0068
%    -0.0064
%    -0.0059
%    -0.0054
%    -0.0048
%    -0.0042
%    -0.0036
%    -0.0028
%    -0.0021
%    -0.0013
%    -0.0005
%     0.0002
%     0.0010
%     0.0018
%     0.0026
%     0.0033
%     0.0040
%     0.0047
%     0.0053
%     0.0059
%     0.0064
%     0.0068
%     0.0072
%     0.0075
%     0.0077
%     0.0078
%     0.0079
%     0.0079
%     0.0078
%     0.0076
%     0.0074
%     0.0070
%     0.0067
%     0.0062
%     0.0058
%     0.0052
%     0.0047
%     0.0041
%     0.0035
%     0.0028
%     0.0022
%     0.0016
%     0.0009
%     0.0003
%    -0.0003
%    -0.0009
%    -0.0014
%    -0.0019
%    -0.0024
%    -0.0028
%    -0.0032
%    -0.0035
%    -0.0038
%    -0.0040
%    -0.0042
%    -0.0043
%    -0.0044
%    -0.0044
%    -0.0044
%    -0.0044
%    -0.0043
%    -0.0041
%    -0.0040
%    -0.0038
%    -0.0036
%    -0.0033
%    -0.0031
%    -0.0028
%    -0.0026
%    -0.0023
%    -0.0021
%    -0.0018
%    -0.0015
%    -0.0013
%    -0.0011
%    -0.0009
%    -0.0007
%    -0.0005
%    -0.0003
%    -0.0002
%    -0.0001
%     0.0001
%     0.0001
%     0.0002
%     0.0003
%     0.0003
%     0.0003
%     0.0003
%     0.0003
%     0.0003
%     0.0003
%     0.0002
%     0.0002
%     0.0001
%     0.0001
%     0.0000
%
% When M = 10, the residual is
% 
%     0.0000
%     0.1360
%     0.2690
%     0.3962
%     0.5148
%     0.6223
%     0.7162
%     0.7946
%     0.8559
%     0.8987
%     0.9222
%     0.9259
%     0.9097
%     0.8742
%     0.8201
%     0.7487
%     0.6616
%     0.5607
%     0.4483
%     0.3267
%     0.1988
%     0.0671
%    -0.0654
%    -0.1958
%    -0.3215
%    -0.4398
%    -0.5481
%    -0.6443
%    -0.7263
%    -0.7926
%    -0.8417
%    -0.8729
%    -0.8854
%    -0.8793
%    -0.8547
%    -0.8123
%    -0.7531
%    -0.6785
%    -0.5901
%    -0.4900
%    -0.3803
%    -0.2634
%    -0.1419
%    -0.0182
%     0.1049
%     0.2249
%     0.3394
%     0.4459
%     0.5423
%     0.6267
%     0.6974
%     0.7530
%     0.7925
%     0.8153
%     0.8210
%     0.8096
%     0.7815
%     0.7375
%     0.6786
%     0.6062
%     0.5219
%     0.4276
%     0.3252
%     0.2171
%     0.1055
%    -0.0073
%    -0.1189
%    -0.2270
%    -0.3294
%    -0.4241
%    -0.5092
%    -0.5830
%    -0.6441
%    -0.6914
%    -0.7241
%    -0.7416
%    -0.7438
%    -0.7307
%    -0.7028
%    -0.6609
%    -0.6058
%    -0.5390
%    -0.4619
%    -0.3761
%    -0.2836
%    -0.1864
%    -0.0863
%     0.0144
%     0.1137
%     0.2096
%     0.3001
%     0.3836
%     0.4583
%     0.5229
%     0.5762
%     0.6172
%     0.6451
%     0.6597
%     0.6608
%     0.6485
%     0.6233
%     0.5858
%     0.5368
%     0.4777
%     0.4097
%     0.3342
%     0.2529
%     0.1676
%     0.0800
%    -0.0081
%    -0.0950
%    -0.1788
%    -0.2579
%    -0.3308
%    -0.3961
%    -0.4526
%    -0.4993
%    -0.5354
%    -0.5602
%    -0.5736
%    -0.5753
%    -0.5654
%    -0.5445
%    -0.5129
%    -0.4716
%    -0.4215
%    -0.3637
%    -0.2995
%    -0.2303
%    -0.1576
%    -0.0827
%    -0.0074
%     0.0669
%     0.1388
%     0.2069
%     0.2698
%     0.3264
%     0.3757
%     0.4168
%     0.4490
%     0.4719
%     0.4850
%     0.4885
%     0.4822
%     0.4666
%     0.4421
%     0.4094
%     0.3692
%     0.3224
%     0.2701
%     0.2134
%     0.1536
%     0.0918
%     0.0293
%    -0.0326
%    -0.0928
%    -0.1501
%    -0.2034
%    -0.2519
%    -0.2945
%    -0.3306
%    -0.3597
%    -0.3813
%    -0.3951
%    -0.4011
%    -0.3992
%    -0.3897
%    -0.3729
%    -0.3494
%    -0.3196
%    -0.2843
%    -0.2443
%    -0.2005
%    -0.1538
%    -0.1052
%    -0.0556
%    -0.0060
%     0.0426
%     0.0894
%     0.1335
%     0.1741
%     0.2105
%     0.2422
%     0.2686
%     0.2894
%     0.3044
%     0.3134
%     0.3164
%     0.3135
%     0.3048
%     0.2908
%     0.2719
%     0.2484
%     0.2209
%     0.1902
%     0.1568
%     0.1213
%     0.0846
%     0.0473
%     0.0102
%    -0.0262
%    -0.0612
%    -0.0942
%    -0.1247
%    -0.1522
%    -0.1763
%    -0.1967
%    -0.2132
%    -0.2255
%    -0.2337
%    -0.2377
%    -0.2375
%    -0.2333
%    -0.2254
%    -0.2139
%    -0.1992
%    -0.1816
%    -0.1615
%    -0.1393
%    -0.1155
%    -0.0905
%    -0.0647
%    -0.0385
%    -0.0125
%     0.0131
%     0.0378
%     0.0613
%     0.0833
%     0.1035
%     0.1217
%     0.1376
%     0.1511
%     0.1622
%     0.1706
%     0.1765
%     0.1797
%     0.1803
%     0.1784
%     0.1740
%     0.1673
%     0.1584
%     0.1475
%     0.1347
%     0.1202
%     0.1043
%     0.0871
%     0.0688
%     0.0497
%     0.0301
%     0.0101
%    -0.0101
%    -0.0301
%    -0.0497
%    -0.0688
%    -0.0871
%    -0.1043
%    -0.1202
%    -0.1347
%    -0.1475
%    -0.1584
%    -0.1673
%    -0.1740
%    -0.1784
%    -0.1803
%    -0.1797
%    -0.1765
%    -0.1706
%    -0.1622
%    -0.1511
%    -0.1376
%    -0.1217
%    -0.1035
%    -0.0833
%    -0.0613
%    -0.0378
%    -0.0131
%     0.0125
%     0.0385
%     0.0647
%     0.0905
%     0.1155
%     0.1393
%     0.1615
%     0.1816
%     0.1992
%     0.2139
%     0.2254
%     0.2333
%     0.2375
%     0.2377
%     0.2337
%     0.2255
%     0.2132
%     0.1967
%     0.1763
%     0.1522
%     0.1247
%     0.0942
%     0.0612
%     0.0262
%    -0.0102
%    -0.0473
%    -0.0846
%    -0.1213
%    -0.1568
%    -0.1902
%    -0.2209
%    -0.2484
%    -0.2719
%    -0.2908
%    -0.3048
%    -0.3135
%    -0.3164
%    -0.3134
%    -0.3044
%    -0.2894
%    -0.2686
%    -0.2422
%    -0.2105
%    -0.1741
%    -0.1335
%    -0.0894
%    -0.0426
%     0.0060
%     0.0556
%     0.1052
%     0.1538
%     0.2005
%     0.2443
%     0.2843
%     0.3196
%     0.3494
%     0.3729
%     0.3897
%     0.3992
%     0.4011
%     0.3951
%     0.3813
%     0.3597
%     0.3306
%     0.2945
%     0.2519
%     0.2034
%     0.1501
%     0.0928
%     0.0326
%    -0.0293
%    -0.0918
%    -0.1536
%    -0.2134
%    -0.2701
%    -0.3224
%    -0.3692
%    -0.4094
%    -0.4421
%    -0.4666
%    -0.4822
%    -0.4885
%    -0.4850
%    -0.4719
%    -0.4490
%    -0.4168
%    -0.3757
%    -0.3264
%    -0.2698
%    -0.2069
%    -0.1388
%    -0.0669
%     0.0074
%     0.0827
%     0.1576
%     0.2303
%     0.2995
%     0.3637
%     0.4215
%     0.4716
%     0.5129
%     0.5445
%     0.5654
%     0.5753
%     0.5736
%     0.5602
%     0.5354
%     0.4993
%     0.4526
%     0.3961
%     0.3308
%     0.2579
%     0.1788
%     0.0950
%     0.0081
%    -0.0800
%    -0.1676
%    -0.2529
%    -0.3342
%    -0.4097
%    -0.4777
%    -0.5368
%    -0.5858
%    -0.6233
%    -0.6485
%    -0.6608
%    -0.6597
%    -0.6451
%    -0.6172
%    -0.5762
%    -0.5229
%    -0.4583
%    -0.3836
%    -0.3001
%    -0.2096
%    -0.1137
%    -0.0144
%     0.0863
%     0.1864
%     0.2836
%     0.3761
%     0.4619
%     0.5390
%     0.6058
%     0.6609
%     0.7028
%     0.7307
%     0.7438
%     0.7416
%     0.7241
%     0.6914
%     0.6441
%     0.5830
%     0.5092
%     0.4241
%     0.3294
%     0.2270
%     0.1189
%     0.0073
%    -0.1055
%    -0.2171
%    -0.3252
%    -0.4276
%    -0.5219
%    -0.6062
%    -0.6786
%    -0.7375
%    -0.7815
%    -0.8096
%    -0.8210
%    -0.8153
%    -0.7925
%    -0.7530
%    -0.6974
%    -0.6267
%    -0.5423
%    -0.4459
%    -0.3394
%    -0.2249
%    -0.1049
%     0.0182
%     0.1419
%     0.2634
%     0.3803
%     0.4900
%     0.5901
%     0.6785
%     0.7531
%     0.8123
%     0.8547
%     0.8793
%     0.8854
%     0.8729
%     0.8417
%     0.7926
%     0.7263
%     0.6443
%     0.5481
%     0.4398
%     0.3215
%     0.1958
%     0.0654
%    -0.0671
%    -0.1988
%    -0.3267
%    -0.4483
%    -0.5607
%    -0.6616
%    -0.7487
%    -0.8201
%    -0.8742
%    -0.9097
%    -0.9259
%    -0.9222
%    -0.8987
%    -0.8559
%    -0.7946
%    -0.7162
%    -0.6223
%    -0.5148
%    -0.3962
%    -0.2690
%    -0.1360
%    -0.0000
%
% When M = 20, the residual is
%
%    -0.0000
%     0.0849
%     0.1622
%     0.2253
%     0.2689
%     0.2893
%     0.2854
%     0.2579
%     0.2098
%     0.1455
%     0.0707
%    -0.0079
%    -0.0841
%    -0.1517
%    -0.2055
%    -0.2418
%    -0.2582
%    -0.2541
%    -0.2305
%    -0.1898
%    -0.1358
%    -0.0729
%    -0.0064
%     0.0588
%     0.1177
%     0.1660
%     0.2006
%     0.2193
%     0.2213
%     0.2069
%     0.1776
%     0.1362
%     0.0860
%     0.0309
%    -0.0249
%    -0.0773
%    -0.1228
%    -0.1581
%    -0.1811
%    -0.1905
%    -0.1861
%    -0.1684
%    -0.1392
%    -0.1008
%    -0.0563
%    -0.0089
%     0.0379
%     0.0809
%     0.1171
%     0.1442
%     0.1605
%     0.1651
%     0.1581
%     0.1401
%     0.1128
%     0.0782
%     0.0389
%    -0.0021
%    -0.0422
%    -0.0784
%    -0.1083
%    -0.1301
%    -0.1424
%    -0.1446
%    -0.1368
%    -0.1196
%    -0.0946
%    -0.0635
%    -0.0287
%     0.0074
%     0.0422
%     0.0735
%     0.0992
%     0.1175
%     0.1274
%     0.1284
%     0.1206
%     0.1047
%     0.0819
%     0.0539
%     0.0227
%    -0.0095
%    -0.0404
%    -0.0681
%    -0.0907
%    -0.1067
%    -0.1152
%    -0.1156
%    -0.1082
%    -0.0936
%    -0.0728
%    -0.0474
%    -0.0192
%     0.0099
%     0.0378
%     0.0628
%     0.0832
%     0.0976
%     0.1051
%     0.1055
%     0.0987
%     0.0853
%     0.0663
%     0.0431
%     0.0173
%    -0.0093
%    -0.0350
%    -0.0579
%    -0.0766
%    -0.0899
%    -0.0969
%    -0.0973
%    -0.0911
%    -0.0789
%    -0.0615
%    -0.0401
%    -0.0163
%     0.0083
%     0.0321
%     0.0534
%     0.0709
%     0.0834
%     0.0901
%     0.0907
%     0.0852
%     0.0740
%     0.0579
%     0.0381
%     0.0160
%    -0.0070
%    -0.0293
%    -0.0493
%    -0.0659
%    -0.0779
%    -0.0845
%    -0.0853
%    -0.0804
%    -0.0702
%    -0.0553
%    -0.0369
%    -0.0161
%     0.0055
%     0.0266
%     0.0457
%     0.0616
%     0.0732
%     0.0797
%     0.0809
%     0.0766
%     0.0672
%     0.0534
%     0.0361
%     0.0165
%    -0.0040
%    -0.0241
%    -0.0424
%    -0.0578
%    -0.0691
%    -0.0758
%    -0.0773
%    -0.0736
%    -0.0650
%    -0.0521
%    -0.0357
%    -0.0172
%     0.0025
%     0.0218
%     0.0395
%     0.0545
%     0.0657
%     0.0724
%     0.0743
%     0.0711
%     0.0632
%     0.0511
%     0.0357
%     0.0180
%    -0.0009
%    -0.0196
%    -0.0369
%    -0.0516
%    -0.0627
%    -0.0696
%    -0.0718
%    -0.0692
%    -0.0620
%    -0.0506
%    -0.0359
%    -0.0189
%    -0.0007
%     0.0175
%     0.0344
%     0.0490
%     0.0602
%     0.0673
%     0.0699
%     0.0678
%     0.0611
%     0.0504
%     0.0364
%     0.0199
%     0.0022
%    -0.0156
%    -0.0322
%    -0.0467
%    -0.0580
%    -0.0654
%    -0.0683
%    -0.0667
%    -0.0606
%    -0.0505
%    -0.0370
%    -0.0211
%    -0.0038
%     0.0137
%     0.0302
%     0.0447
%     0.0561
%     0.0638
%     0.0671
%     0.0660
%     0.0604
%     0.0508
%     0.0378
%     0.0223
%     0.0054
%    -0.0119
%    -0.0284
%    -0.0429
%    -0.0546
%    -0.0625
%    -0.0663
%    -0.0656
%    -0.0605
%    -0.0514
%    -0.0388
%    -0.0237
%    -0.0069
%     0.0102
%     0.0267
%     0.0414
%     0.0532
%     0.0616
%     0.0657
%     0.0655
%     0.0609
%     0.0522
%     0.0400
%     0.0251
%     0.0086
%    -0.0086
%    -0.0251
%    -0.0400
%    -0.0522
%    -0.0609
%    -0.0655
%    -0.0657
%    -0.0616
%    -0.0532
%    -0.0414
%    -0.0267
%    -0.0102
%     0.0069
%     0.0237
%     0.0388
%     0.0514
%     0.0605
%     0.0656
%     0.0663
%     0.0625
%     0.0546
%     0.0429
%     0.0284
%     0.0119
%    -0.0054
%    -0.0223
%    -0.0378
%    -0.0508
%    -0.0604
%    -0.0660
%    -0.0671
%    -0.0638
%    -0.0561
%    -0.0447
%    -0.0302
%    -0.0137
%     0.0038
%     0.0211
%     0.0370
%     0.0505
%     0.0606
%     0.0667
%     0.0683
%     0.0654
%     0.0580
%     0.0467
%     0.0322
%     0.0156
%    -0.0022
%    -0.0199
%    -0.0364
%    -0.0504
%    -0.0611
%    -0.0678
%    -0.0699
%    -0.0673
%    -0.0602
%    -0.0490
%    -0.0344
%    -0.0175
%     0.0007
%     0.0189
%     0.0359
%     0.0506
%     0.0620
%     0.0692
%     0.0718
%     0.0696
%     0.0627
%     0.0516
%     0.0369
%     0.0196
%     0.0009
%    -0.0180
%    -0.0357
%    -0.0511
%    -0.0632
%    -0.0711
%    -0.0743
%    -0.0724
%    -0.0657
%    -0.0545
%    -0.0395
%    -0.0218
%    -0.0025
%     0.0172
%     0.0357
%     0.0521
%     0.0650
%     0.0736
%     0.0773
%     0.0758
%     0.0691
%     0.0578
%     0.0424
%     0.0241
%     0.0040
%    -0.0165
%    -0.0361
%    -0.0534
%    -0.0672
%    -0.0766
%    -0.0809
%    -0.0797
%    -0.0732
%    -0.0616
%    -0.0457
%    -0.0266
%    -0.0055
%     0.0161
%     0.0369
%     0.0553
%     0.0702
%     0.0804
%     0.0853
%     0.0845
%     0.0779
%     0.0659
%     0.0493
%     0.0293
%     0.0070
%    -0.0160
%    -0.0381
%    -0.0579
%    -0.0740
%    -0.0852
%    -0.0907
%    -0.0901
%    -0.0834
%    -0.0709
%    -0.0534
%    -0.0321
%    -0.0083
%     0.0163
%     0.0401
%     0.0615
%     0.0789
%     0.0911
%     0.0973
%     0.0969
%     0.0899
%     0.0766
%     0.0579
%     0.0350
%     0.0093
%    -0.0173
%    -0.0431
%    -0.0663
%    -0.0853
%    -0.0987
%    -0.1055
%    -0.1051
%    -0.0976
%    -0.0832
%    -0.0628
%    -0.0378
%    -0.0099
%     0.0192
%     0.0474
%     0.0728
%     0.0936
%     0.1082
%     0.1156
%     0.1152
%     0.1067
%     0.0907
%     0.0681
%     0.0404
%     0.0095
%    -0.0227
%    -0.0539
%    -0.0819
%    -0.1047
%    -0.1206
%    -0.1284
%    -0.1274
%    -0.1175
%    -0.0992
%    -0.0735
%    -0.0422
%    -0.0074
%     0.0287
%     0.0635
%     0.0946
%     0.1196
%     0.1368
%     0.1446
%     0.1424
%     0.1301
%     0.1083
%     0.0784
%     0.0422
%     0.0021
%    -0.0389
%    -0.0782
%    -0.1128
%    -0.1401
%    -0.1581
%    -0.1651
%    -0.1605
%    -0.1442
%    -0.1171
%    -0.0809
%    -0.0379
%     0.0089
%     0.0563
%     0.1008
%     0.1392
%     0.1684
%     0.1861
%     0.1905
%     0.1811
%     0.1581
%     0.1228
%     0.0773
%     0.0249
%    -0.0309
%    -0.0860
%    -0.1362
%    -0.1776
%    -0.2069
%    -0.2213
%    -0.2193
%    -0.2006
%    -0.1660
%    -0.1177
%    -0.0588
%     0.0064
%     0.0729
%     0.1358
%     0.1898
%     0.2305
%     0.2541
%     0.2582
%     0.2418
%     0.2055
%     0.1517
%     0.0841
%     0.0079
%    -0.0707
%    -0.1455
%    -0.2098
%    -0.2579
%    -0.2854
%    -0.2893
%    -0.2689
%    -0.2253
%    -0.1622
%    -0.0849
%     0.0000
%
% When M = 40, the resiudal is
%
%    -0.0000
%     0.4383
%     0.7256
%     0.7694
%     0.5662
%     0.1949
%    -0.2170
%    -0.5398
%    -0.6821
%    -0.6145
%    -0.3721
%    -0.0378
%     0.2859
%     0.5081
%     0.5738
%     0.4757
%     0.2522
%    -0.0268
%    -0.2815
%    -0.4445
%    -0.4778
%    -0.3806
%    -0.1868
%     0.0460
%     0.2539
%     0.3832
%     0.4043
%     0.3176
%     0.1517
%    -0.0458
%    -0.2216
%    -0.3311
%    -0.3489
%    -0.2750
%    -0.1329
%     0.0375
%     0.1907
%     0.2880
%     0.3066
%     0.2452
%     0.1229
%    -0.0263
%    -0.1628
%    -0.2522
%    -0.2733
%    -0.2234
%    -0.1178
%     0.0143
%     0.1381
%     0.2222
%     0.2464
%     0.2067
%     0.1153
%    -0.0026
%    -0.1162
%    -0.1965
%    -0.2241
%    -0.1935
%    -0.1144
%    -0.0084
%     0.0967
%     0.1741
%     0.2050
%     0.1826
%     0.1143
%     0.0186
%    -0.0793
%    -0.1544
%    -0.1883
%    -0.1733
%    -0.1145
%    -0.0279
%     0.0636
%     0.1368
%     0.1734
%     0.1650
%     0.1148
%     0.0365
%    -0.0494
%    -0.1208
%    -0.1600
%    -0.1575
%    -0.1151
%    -0.0442
%     0.0365
%     0.1062
%     0.1476
%     0.1506
%     0.1152
%     0.0512
%    -0.0247
%    -0.0928
%    -0.1361
%    -0.1439
%    -0.1151
%    -0.0574
%     0.0138
%     0.0803
%     0.1252
%     0.1375
%     0.1147
%     0.0631
%    -0.0038
%    -0.0686
%    -0.1149
%    -0.1313
%    -0.1141
%    -0.0681
%    -0.0055
%     0.0576
%     0.1051
%     0.1252
%     0.1131
%     0.0725
%     0.0140
%    -0.0472
%    -0.0956
%    -0.1191
%    -0.1119
%    -0.0764
%    -0.0219
%     0.0374
%     0.0865
%     0.1130
%     0.1104
%     0.0798
%     0.0293
%    -0.0281
%    -0.0776
%    -0.1068
%    -0.1085
%    -0.0826
%    -0.0360
%     0.0193
%     0.0690
%     0.1007
%     0.1064
%     0.0850
%     0.0422
%    -0.0109
%    -0.0607
%    -0.0945
%    -0.1040
%    -0.0869
%    -0.0479
%     0.0029
%     0.0525
%     0.0883
%     0.1013
%     0.0884
%     0.0532
%     0.0047
%    -0.0445
%    -0.0820
%    -0.0983
%    -0.0895
%    -0.0579
%    -0.0119
%     0.0368
%     0.0757
%     0.0951
%     0.0901
%     0.0622
%     0.0188
%    -0.0292
%    -0.0693
%    -0.0916
%    -0.0903
%    -0.0661
%    -0.0253
%     0.0218
%     0.0629
%     0.0878
%     0.0902
%     0.0696
%     0.0314
%    -0.0145
%    -0.0565
%    -0.0838
%    -0.0896
%    -0.0726
%    -0.0372
%     0.0075
%     0.0500
%     0.0795
%     0.0887
%     0.0752
%     0.0427
%    -0.0006
%    -0.0435
%    -0.0751
%    -0.0874
%    -0.0774
%    -0.0478
%    -0.0061
%     0.0370
%     0.0704
%     0.0858
%     0.0792
%     0.0525
%     0.0126
%    -0.0304
%    -0.0655
%    -0.0838
%    -0.0806
%    -0.0570
%    -0.0189
%     0.0239
%     0.0604
%     0.0815
%     0.0816
%     0.0610
%     0.0249
%    -0.0174
%    -0.0552
%    -0.0788
%    -0.0823
%    -0.0648
%    -0.0308
%     0.0109
%     0.0498
%     0.0759
%     0.0825
%     0.0682
%     0.0364
%    -0.0045
%    -0.0442
%    -0.0726
%    -0.0824
%    -0.0712
%    -0.0419
%    -0.0019
%     0.0385
%     0.0690
%     0.0819
%     0.0739
%     0.0470
%     0.0082
%    -0.0327
%    -0.0652
%    -0.0810
%    -0.0762
%    -0.0520
%    -0.0145
%     0.0267
%     0.0610
%     0.0798
%     0.0782
%     0.0566
%     0.0206
%    -0.0206
%    -0.0566
%    -0.0782
%    -0.0798
%    -0.0610
%    -0.0267
%     0.0145
%     0.0520
%     0.0762
%     0.0810
%     0.0652
%     0.0327
%    -0.0082
%    -0.0470
%    -0.0739
%    -0.0819
%    -0.0690
%    -0.0385
%     0.0019
%     0.0419
%     0.0712
%     0.0824
%     0.0726
%     0.0442
%     0.0045
%    -0.0364
%    -0.0682
%    -0.0825
%    -0.0759
%    -0.0498
%    -0.0109
%     0.0308
%     0.0648
%     0.0823
%     0.0788
%     0.0552
%     0.0174
%    -0.0249
%    -0.0610
%    -0.0816
%    -0.0815
%    -0.0604
%    -0.0239
%     0.0189
%     0.0570
%     0.0806
%     0.0838
%     0.0655
%     0.0304
%    -0.0126
%    -0.0525
%    -0.0792
%    -0.0858
%    -0.0704
%    -0.0370
%     0.0061
%     0.0478
%     0.0774
%     0.0874
%     0.0751
%     0.0435
%     0.0006
%    -0.0427
%    -0.0752
%    -0.0887
%    -0.0795
%    -0.0500
%    -0.0075
%     0.0372
%     0.0726
%     0.0896
%     0.0838
%     0.0565
%     0.0145
%    -0.0314
%    -0.0696
%    -0.0902
%    -0.0878
%    -0.0629
%    -0.0218
%     0.0253
%     0.0661
%     0.0903
%     0.0916
%     0.0693
%     0.0292
%    -0.0188
%    -0.0622
%    -0.0901
%    -0.0951
%    -0.0757
%    -0.0368
%     0.0119
%     0.0579
%     0.0895
%     0.0983
%     0.0820
%     0.0445
%    -0.0047
%    -0.0532
%    -0.0884
%    -0.1013
%    -0.0883
%    -0.0525
%    -0.0029
%     0.0479
%     0.0869
%     0.1040
%     0.0945
%     0.0607
%     0.0109
%    -0.0422
%    -0.0850
%    -0.1064
%    -0.1007
%    -0.0690
%    -0.0193
%     0.0360
%     0.0826
%     0.1085
%     0.1068
%     0.0776
%     0.0281
%    -0.0293
%    -0.0798
%    -0.1104
%    -0.1130
%    -0.0865
%    -0.0374
%     0.0219
%     0.0764
%     0.1119
%     0.1191
%     0.0956
%     0.0472
%    -0.0140
%    -0.0725
%    -0.1131
%    -0.1252
%    -0.1051
%    -0.0576
%     0.0055
%     0.0681
%     0.1141
%     0.1313
%     0.1149
%     0.0686
%     0.0038
%    -0.0631
%    -0.1147
%    -0.1375
%    -0.1252
%    -0.0803
%    -0.0138
%     0.0574
%     0.1151
%     0.1439
%     0.1361
%     0.0928
%     0.0247
%    -0.0512
%    -0.1152
%    -0.1506
%    -0.1476
%    -0.1062
%    -0.0365
%     0.0442
%     0.1151
%     0.1575
%     0.1600
%     0.1208
%     0.0494
%    -0.0365
%    -0.1148
%    -0.1650
%    -0.1734
%    -0.1368
%    -0.0636
%     0.0279
%     0.1145
%     0.1733
%     0.1883
%     0.1544
%     0.0793
%    -0.0186
%    -0.1143
%    -0.1826
%    -0.2050
%    -0.1741
%    -0.0967
%     0.0084
%     0.1144
%     0.1935
%     0.2241
%     0.1965
%     0.1162
%     0.0026
%    -0.1153
%    -0.2067
%    -0.2464
%    -0.2222
%    -0.1381
%    -0.0143
%     0.1178
%     0.2234
%     0.2733
%     0.2522
%     0.1628
%     0.0263
%    -0.1229
%    -0.2452
%    -0.3066
%    -0.2880
%    -0.1907
%    -0.0375
%     0.1329
%     0.2750
%     0.3489
%     0.3311
%     0.2216
%     0.0458
%    -0.1517
%    -0.3176
%    -0.4043
%    -0.3832
%    -0.2539
%    -0.0460
%     0.1868
%     0.3806
%     0.4778
%     0.4445
%     0.2815
%     0.0268
%    -0.2522
%    -0.4757
%    -0.5738
%    -0.5081
%    -0.2859
%     0.0378
%     0.3721
%     0.6145
%     0.6821
%     0.5398
%     0.2170
%    -0.1949
%    -0.5662
%    -0.7694
%    -0.7256
%    -0.4383
%     0.0000
%
% b) This process is called the Fourier Sine Series.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
